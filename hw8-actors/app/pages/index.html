<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" content="text/html"/>
    <title>Title</title>

    <script src="js/jquery.min.js"></script>
    <link href="css/bootstrap.css" rel="stylesheet">
    <script src="js/bootstrap.js"></script>
    <link href="css/custom.css" rel="stylesheet">
    <script type="text/javascript" src="js/handlebars-v3.0.3.js"></script>

</head>
<body style="margin-bottom: 50px">

    <div class="container" id="schedule">
    	<div class="col-md-10 col-md-offset-1" style="padding: 0; margin-top: 30px">
            <form style="margin-bottom: 5px" id="searchInput">
                <div class="input-group">
                    <input type="text" class="form-control" name="qField" id = "qField" placeholder="Введите запрос">

                    <span class="input-group-btn">
                        <button type="button" class="btn btn-primary" onclick="search();">
                        	<span class="glyphicon glyphicon-search"></span></button>
                    </span>
                </div>
            </form>
        </div>

        <div class="col-md-10 col-md-offset-1" style="padding: 0;" id="search-results">
        </div>
    </div>


    <!--Templates-->
    <script id="result-template" type="text/x-handlebars-template">
    	<div class="col-md-12" style="padding: 0; margin-top: 10px; border-style: solid;">
    		<h2>{{title}}</h2>
    		<h3>{{url}}</h3>
    		<h4>{{searchSys}}</h4>
        </div>
    </script>


    <!--Scripts-->
    <script>
        var counter = 0;
        var resTemplate = Handlebars.compile($('#result-template').html());

        function search() {
        	var val = $('#qField').val();
        	console.log(val);
        	$.ajax({
                type: "GET",
                url: "api/query/" + val,
                success: function(msg) {
                	msg = "{\"responses\" : " + msg + "}";
                	var resp = JSON.parse(msg).responses;

                    $('#search-results').html('');

                	for (var i = 0; i < resp.length; ++i)
                        $('#search-results').append(resTemplate(resp[i]));
                },
                error: function () {
                	console.log("Erorr during request");
                }
            });
        }
    </script>
</body>
</html>